<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Admin - IZIPRET</title>
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #1e40af;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-color: #111827;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: #f8fafc;
            color: #374151;
        }
        
        .dashboard-section {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .dashboard-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Sidebar */
        .sidebar {
            width: 260px;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        
        @media (min-width: 1024px) {
            .sidebar {
                transform: translateX(0);
            }
        }
        
        .sidebar.active {
            transform: translateX(0);
        }
        
        /* Status badges */
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-pending {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .status-validated {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .status-delivered {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        /* Notification badge */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--danger-color);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 11px;
            font-weight: bold;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #a1a1a1;
        }
        
        /* Form field styling */
        .form-field {
            transition: all 0.2s ease;
        }
        
        .form-field:focus-within {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* Animation for new orders */
        @keyframes highlightNew {
            0% { background-color: rgba(254, 243, 199, 0.5); }
            100% { background-color: transparent; }
        }
        
        .new-order {
            animation: highlightNew 2s ease;
        }
        
        /* Mobile menu backdrop */
        .mobile-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 40;
            display: none;
        }
        
        .mobile-backdrop.active {
            display: block;
        }
    </style>
</head>
<body class="min-h-screen">
 
    
    <!-- Login Screen (initial) -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center bg-gray-50 px-4">
        <div class="max-w-md w-full bg-white rounded-xl shadow-lg p-8">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Dashboard Admin</h1>
                <p class="text-gray-600">Connectez-vous pour gérer votre boutique</p>
            </div>
            
            <form id="login-form" class="space-y-6">
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="email" required 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Mot de passe</label>
                    <input type="password" id="password" required 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
                    Se connecter
                </button>
                
                <div id="login-error" class="hidden p-3 bg-red-50 text-red-600 rounded-lg text-sm">
                    <i class="fas fa-exclamation-circle mr-2"></i>
                    <span id="error-message"></span>
                </div>
            </form>
            
            <div class="mt-6 text-center text-sm text-gray-500">
                <p>Accès réservé aux administrateurs autorisés</p>
                <p class="mt-1">© IZIPRET Dashboard</p>
            </div>
        </div>
    </div>
    
    <!-- Dashboard Container (hidden until login) -->
    <div id="dashboard-container" class="hidden">
        <!-- Mobile Menu Backdrop -->
        <div id="mobile-backdrop" class="mobile-backdrop lg:hidden"></div>
        
        <!-- Sidebar -->
        <aside class="sidebar fixed top-0 left-0 h-full bg-white shadow-lg z-50 lg:relative lg:z-0">
            <div class="p-6 border-b">
                <div class="flex items-center justify-between">
                    <h1 class="text-xl font-bold text-gray-900">IZIPRET Admin</h1>
                    <button id="close-sidebar" class="lg:hidden text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-500 mt-1">Dashboard de gestion</p>
            </div>
            
            <nav class="p-4 space-y-2">
                <a href="#" class="nav-item flex items-center p-3 rounded-lg text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition" data-section="products">
                    <i class="fas fa-box text-lg w-6 mr-3"></i>
                    <span>Gestion Produits</span>
                </a>
                
                <a href="#" class="nav-item flex items-center p-3 rounded-lg text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition" data-section="delivery">
                    <i class="fas fa-shipping-fast text-lg w-6 mr-3"></i>
                    <span>Livraison & Logistique</span>
                </a>
                
                <a href="#" class="nav-item flex items-center p-3 rounded-lg text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition" data-section="orders">
                    <i class="fas fa-shopping-cart text-lg w-6 mr-3"></i>
                    <span>Commandes</span>
                    <span id="orders-badge" class="notification-badge hidden">0</span>
                </a>
                
                <a href="#" class="nav-item flex items-center p-3 rounded-lg text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition" data-section="history">
                    <i class="fas fa-history text-lg w-6 mr-3"></i>
                    <span>Historique</span>
                </a>
                
                <a href="#" class="nav-item flex items-center p-3 rounded-lg text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition" data-section="about">
                    <i class="fas fa-building text-lg w-6 mr-3"></i>
                    <span>Page About</span>
                </a>
                
                <a href="#" class="nav-item flex items-center p-3 rounded-lg text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition" data-section="legal">
                    <i class="fas fa-file-contract text-lg w-6 mr-3"></i>
                    <span>Pages Légales</span>
                </a>
                
                <div class="pt-8 mt-8 border-t">
                    <button id="logout-btn" class="w-full flex items-center p-3 rounded-lg text-red-600 hover:bg-red-50 transition">
                        <i class="fas fa-sign-out-alt text-lg w-6 mr-3"></i>
                        <span>Déconnexion</span>
                    </button>
                </div>
            </nav>
            
            <div class="absolute bottom-0 left-0 right-0 p-4 border-t text-xs text-gray-500">
                <p>Dashboard v1.0</p>
                <p class="mt-1">© IZIPRET 2024</p>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="lg:ml-64 min-h-screen">
            <!-- Top Bar -->
            <header class="bg-white shadow-sm px-4 py-3 flex items-center justify-between sticky top-0 z-30">
                <button id="menu-toggle" class="lg:hidden text-gray-600 hover:text-gray-900">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                
                <div class="flex-1 ml-4">
                    <h2 id="section-title" class="text-lg font-semibold text-gray-800">Gestion Produits</h2>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="hidden md:block text-sm text-gray-600">
                        <span id="current-date"></span>
                    </div>
                    
                    <div class="relative">
                        <button id="notifications-btn" class="text-gray-600 hover:text-gray-900 relative">
                            <i class="fas fa-bell text-xl"></i>
                            <span id="notification-badge" class="notification-badge hidden">0</span>
                        </button>
                        
                        <!-- Notifications Dropdown -->
                        <div id="notifications-dropdown" class="hidden absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border z-40">
                            <div class="p-4 border-b">
                                <h3 class="font-semibold text-gray-800">Notifications</h3>
                            </div>
                            <div id="notifications-list" class="max-h-96 overflow-y-auto p-2">
                                <!-- Notifications will be added here -->
                                <div class="text-center py-8 text-gray-500">
                                    <i class="fas fa-bell-slash text-3xl mb-3"></i>
                                    <p>Aucune notification</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center">
                            <i class="fas fa-user text-blue-600"></i>
                        </div>
                        <span id="user-email" class="ml-2 text-sm text-gray-700 hidden md:inline">admin@izipret.com</span>
                    </div>
                </div>
            </header>
            
            <!-- Dashboard Sections -->
            <div class="p-4 md:p-6">
                <!-- ========== SECTION PRODUITS ========== -->
                <section id="products-section" class="dashboard-section active">
                    <div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
                        <div>
                            <h1 class="text-2xl font-bold text-gray-900">Gestion des Produits</h1>
                            <p class="text-gray-600 mt-1">Ajoutez, modifiez ou supprimez les produits de votre boutique</p>
                        </div>
                        <button id="add-product-btn" class="mt-4 md:mt-0 bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition flex items-center">
                            <i class="fas fa-plus mr-2"></i> Ajouter un produit
                        </button>
                    </div>
                    
                    <!-- Products Table -->
                    <div class="bg-white rounded-xl shadow overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Produit</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Catégorie</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Prix</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Statut</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="products-table-body" class="bg-white divide-y divide-gray-200">
                                    <!-- Products will be loaded here -->
                                    <tr>
                                        <td colspan="6" class="px-6 py-12 text-center">
                                            <div class="animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto"></div>
                                            <p class="mt-4 text-gray-500">Chargement des produits...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Product Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6">
                        <div class="bg-white p-6 rounded-xl shadow">
                            <div class="flex items-center">
                                <div class="p-3 rounded-lg bg-blue-100 text-blue-600 mr-4">
                                    <i class="fas fa-box text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500">Total Produits</p>
                                    <p id="total-products" class="text-2xl font-bold">0</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow">
                            <div class="flex items-center">
                                <div class="p-3 rounded-lg bg-green-100 text-green-600 mr-4">
                                    <i class="fas fa-check-circle text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500">Produits Actifs</p>
                                    <p id="active-products" class="text-2xl font-bold">0</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow">
                            <div class="flex items-center">
                                <div class="p-3 rounded-lg bg-yellow-100 text-yellow-600 mr-4">
                                    <i class="fas fa-star text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500">Dans Hero</p>
                                    <p id="hero-products" class="text-2xl font-bold">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- ========== SECTION LIVRAISON ========== -->
                <section id="delivery-section" class="dashboard-section">
                    <div class="mb-6">
                        <h1 class="text-2xl font-bold text-gray-900">Livraison & Logistique</h1>
                        <p class="text-gray-600 mt-1">Configurez les options de livraison et les tarifs</p>
                    </div>
                    
                    <!-- Delivery Settings Tabs -->
                    <div class="mb-6">
                        <div class="border-b border-gray-200">
                            <nav class="flex space-x-8">
                                <button data-tab="meetup" class="tab-btn py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                                    Lieux de rencontre
                                </button>
                                <button data-tab="pricing" class="tab-btn py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                                    Tarifs & Règles
                                </button>
                                <button data-tab="settings" class="tab-btn py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                                    Paramètres
                                </button>
                            </nav>
                        </div>
                    </div>
                    
                    <!-- Meetup Locations Tab -->
                    <div id="meetup-tab" class="tab-content">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-lg font-semibold text-gray-900">Lieux de rencontre</h2>
                                <p class="text-gray-600 text-sm">Définissez les lieux disponibles pour les livraisons par rencontre</p>
                            </div>
                            <button id="add-location-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition flex items-center">
                                <i class="fas fa-plus mr-2"></i> Ajouter un lieu
                            </button>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nom du lieu</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tarif</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Statut</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="locations-table-body" class="bg-white divide-y divide-gray-200">
                                        <!-- Locations will be loaded here -->
                                        <tr>
                                            <td colspan="5" class="px-6 py-12 text-center">
                                                <p class="text-gray-500">Aucun lieu configuré</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pricing Rules Tab -->
                    <div id="pricing-tab" class="tab-content hidden">
                        <div class="mb-6">
                            <h2 class="text-lg font-semibold text-gray-900 mb-2">Règles de tarification</h2>
                            <p class="text-gray-600 text-sm mb-6">Configurez comment les tarifs de livraison sont calculés</p>
                            
                            <div class="bg-white rounded-xl shadow p-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <!-- Weight Pricing -->
                                    <div>
                                        <h3 class="font-medium text-gray-900 mb-4">Tarifs par poids</h3>
                                        <div class="space-y-4">
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <span class="text-gray-700">0 - 5 kg</span>
                                                <span class="font-semibold">2.99€</span>
                                            </div>
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <span class="text-gray-700">5 - 10 kg</span>
                                                <span class="font-semibold">4.99€</span>
                                            </div>
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <span class="text-gray-700">10 - 20 kg</span>
                                                <span class="font-semibold">7.99€</span>
                                            </div>
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <span class="text-gray-700">+20 kg</span>
                                                <span class="font-semibold">10.99€</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Delivery Methods -->
                                    <div>
                                        <h3 class="font-medium text-gray-900 mb-4">Modes de livraison</h3>
                                        <div class="space-y-4">
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div class="flex items-center">
                                                    <i class="fas fa-home text-blue-600 mr-3"></i>
                                                    <span class="text-gray-700">À domicile</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <span class="text-green-600 font-semibold mr-3">Activé</span>
                                                    <button class="text-blue-600 hover:text-blue-800">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div class="flex items-center">
                                                    <i class="fas fa-handshake text-blue-600 mr-3"></i>
                                                    <span class="text-gray-700">Par rencontre</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <span class="text-green-600 font-semibold mr-3">Activé</span>
                                                    <button class="text-blue-600 hover:text-blue-800">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div class="flex items-center">
                                                    <i class="fas fa-store text-blue-600 mr-3"></i>
                                                    <span class="text-gray-700">Point de vente</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <span class="text-green-600 font-semibold mr-3">Activé</span>
                                                    <button class="text-blue-600 hover:text-blue-800">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-8">
                                    <button class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
                                        <i class="fas fa-save mr-2"></i> Enregistrer les modifications
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Settings Tab -->
                    <div id="settings-tab" class="tab-content hidden">
                        <div class="bg-white rounded-xl shadow p-6">
                            <h2 class="text-lg font-semibold text-gray-900 mb-6">Paramètres généraux</h2>
                            
                            <div class="space-y-6">
                                <div>
                                    <h3 class="font-medium text-gray-900 mb-3">Options de livraison</h3>
                                    <div class="space-y-3">
                                        <label class="flex items-center">
                                            <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="ml-2 text-gray-700">Activer la livraison à domicile</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                                            <span class="ml-2 text-gray-700">Activer la livraison par rencontre</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                                            <span class="ml-2 text-gray-700">Activer le retrait en point de vente</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div>
                                    <h3 class="font-medium text-gray-900 mb-3">Heures de livraison</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Début</label>
                                            <input type="time" value="08:00" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Fin</label>
                                            <input type="time" value="18:00" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <h3 class="font-medium text-gray-900 mb-3">Frais supplémentaires</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Frais de service (%)</label>
                                            <input type="number" min="0" max="50" value="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Frais minimum (€)</label>
                                            <input type="number" min="0" step="0.01" value="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="pt-4 border-t">
                                    <button class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
                                        <i class="fas fa-save mr-2"></i> Enregistrer tous les paramètres
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- ========== SECTION COMMANDES ========== -->
                <section id="orders-section" class="dashboard-section">
                    <div class="mb-6">
                        <h1 class="text-2xl font-bold text-gray-900">Commandes en attente</h1>
                        <p class="text-gray-600 mt-1">Gérez les commandes récentes et les livraisons</p>
                    </div>
                    
                    <!-- Order Filters -->
                    <div class="bg-white rounded-xl shadow p-4 mb-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between">
                            <div class="flex items-center space-x-4 mb-4 md:mb-0">
                                <button class="filter-btn px-4 py-2 rounded-lg font-medium bg-blue-600 text-white" data-status="all">
                                    Toutes
                                </button>
                                <button class="filter-btn px-4 py-2 rounded-lg font-medium bg-gray-200 text-gray-700 hover:bg-gray-300" data-status="pending">
                                    En attente
                                </button>
                                <button class="filter-btn px-4 py-2 rounded-lg font-medium bg-gray-200 text-gray-700 hover:bg-gray-300" data-status="validated">
                                    Validées
                                </button>
                            </div>
                            
                            <div class="flex items-center space-x-4">
                                <div class="relative">
                                    <input type="text" id="order-search" placeholder="Rechercher une commande..." 
                                           class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <i class="fas fa-search absolute right-3 top-2.5 text-gray-400"></i>
                                </div>
                                
                                <select id="order-sort" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="newest">Plus récentes</option>
                                    <option value="oldest">Plus anciennes</option>
                                    <option value="amount-high">Montant élevé</option>
                                    <option value="amount-low">Montant faible</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Orders Grid -->
                    <div id="orders-container" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Orders will be loaded here -->
                        <div class="col-span-2 text-center py-12">
                            <div class="animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto"></div>
                            <p class="mt-4 text-gray-500">Chargement des commandes...</p>
                        </div>
                    </div>
                </section>
                
                <!-- ========== SECTION HISTORIQUE ========== -->
                <section id="history-section" class="dashboard-section">
                    <div class="mb-6">
                        <h1 class="text-2xl font-bold text-gray-900">Historique des Commandes</h1>
                        <p class="text-gray-600 mt-1">Consultez l'historique complet de toutes les commandes</p>
                    </div>
                    
                    <!-- History Filters -->
                    <div class="bg-white rounded-xl shadow p-4 mb-6">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Statut</label>
                                <select id="history-status" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                    <option value="">Tous les statuts</option>
                                    <option value="pending">En attente</option>
                                    <option value="validated">Validées</option>
                                    <option value="delivered">Livrées</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Paiement</label>
                                <select id="history-payment" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                    <option value="">Tous les paiements</option>
                                    <option value="moncash">MonCash</option>
                                    <option value="meetup">À la rencontre</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Période</label>
                                <select id="history-period" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                    <option value="all">Toute période</option>
                                    <option value="today">Aujourd'hui</option>
                                    <option value="week">Cette semaine</option>
                                    <option value="month">Ce mois</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Recherche</label>
                                <div class="relative">
                                    <input type="text" id="history-search" placeholder="Code ou client" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                    <i class="fas fa-search absolute right-3 top-2.5 text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4 flex justify-end">
                            <button id="export-history" class="bg-green-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-green-700 transition flex items-center">
                                <i class="fas fa-file-export mr-2"></i> Exporter
                            </button>
                        </div>
                    </div>
                    
                    <!-- History Table -->
                    <div class="bg-white rounded-xl shadow overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Code</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Client</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Produits</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Montant</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Paiement</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Livraison</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Statut</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                    </tr>
                                </thead>
                                <tbody id="history-table-body" class="bg-white divide-y divide-gray-200">
                                    <!-- History will be loaded here -->
                                    <tr>
                                        <td colspan="8" class="px-6 py-12 text-center">
                                            <div class="animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto"></div>
                                            <p class="mt-4 text-gray-500">Chargement de l'historique...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                
                <!-- ========== SECTION ABOUT ========== -->
                <section id="about-section" class="dashboard-section">
                    <div class="mb-6">
                        <h1 class="text-2xl font-bold text-gray-900">Page "À propos"</h1>
                        <p class="text-gray-600 mt-1">Modifiez le contenu de la page de présentation de l'entreprise</p>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow p-6">
                        <!-- Company Story -->
                        <div class="mb-8">
                            <h2 class="text-lg font-semibold text-gray-900 mb-4">Histoire de l'entreprise</h2>
                            <textarea id="company-story" rows="6" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">IZIPRET est née d'une vision simple : rendre accessible des produits de qualité supérieure à des prix justes. Fondée en 2020, notre entreprise s'est rapidement imposée comme une référence dans le domaine du commerce en ligne.

Notre mission est de proposer une expérience d'achat exceptionnelle, alliant simplicité, sécurité et satisfaction client. Chaque produit est soigneusement sélectionné pour répondre aux plus hauts standards de qualité.</textarea>
                            <div class="mt-2 text-sm text-gray-500">Ce texte apparaîtra dans la section "Notre histoire" du site.</div>
                        </div>
                        
                        <!-- CEO Info -->
                        <div class="mb-8">
                            <h2 class="text-lg font-semibold text-gray-900 mb-4">Présentation du PDG</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Nom complet</label>
                                    <input type="text" id="ceo-name" value="Jean Dupont" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Fonction</label>
                                    <input type="text" id="ceo-role" value="PDG & Fondateur" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                </div>
                            </div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                <textarea id="ceo-description" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg">Avec plus de 15 ans d'expérience dans le commerce et la vente en ligne, Jean a fondé IZIPRET avec pour objectif de révolutionner l'expérience d'achat en ligne. Passionné par l'innovation et le service client, il supervise personnellement chaque aspect de l'entreprise pour garantir l'excellence.</textarea>
                            </div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Image du PDG</label>
                                <input type="text" id="ceo-image" value="ceo.jpg" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                <div class="mt-1 text-sm text-gray-500">Nom du fichier image (ex: ceo.jpg). Le fichier doit être uploadé manuellement sur GitHub.</div>
                            </div>
                        </div>
                        
                        <!-- Team Members -->
                        <div>
                            <div class="flex justify-between items-center mb-4">
                                <h2 class="text-lg font-semibold text-gray-900">Équipe</h2>
                                <button id="add-team-member" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition flex items-center">
                                    <i class="fas fa-plus mr-2"></i> Ajouter un membre
                                </button>
                            </div>
                            
                            <div id="team-members" class="space-y-4">
                                <!-- Team members will be added here -->
                                <div class="team-member p-4 border border-gray-200 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Nom</label>
                                            <input type="text" value="Marie Martin" class="w-full px-3 py-2 border border-gray-300 rounded-lg team-name">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Fonction</label>
                                            <input type="text" value="Responsable Marketing" class="w-full px-3 py-2 border border-gray-300 rounded-lg team-role">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Image</label>
                                            <input type="text" value="marie.jpg" class="w-full px-3 py-2 border border-gray-300 rounded-lg team-image">
                                        </div>
                                    </div>
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                        <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg team-description" rows="2">Spécialiste en stratégie digitale avec 8 ans d'expérience.</textarea>
                                    </div>
                                    <div class="flex justify-end">
                                        <button class="remove-team-member text-red-600 hover:text-red-800 text-sm">
                                            <i class="fas fa-trash mr-1"></i> Supprimer
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-8 pt-6 border-t">
                            <button id="save-about" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
                                <i class="fas fa-save mr-2"></i> Enregistrer toutes les modifications
                            </button>
                        </div>
                    </div>
                </section>
                
                <!-- ========== SECTION LÉGALES ========== -->
                <section id="legal-section" class="dashboard-section">
                    <div class="mb-6">
                        <h1 class="text-2xl font-bold text-gray-900">Pages Légales</h1>
                        <p class="text-gray-600 mt-1">Modifiez les pages de politique de livraison et de confidentialité</p>
                    </div>
                    
                    <!-- Legal Pages Tabs -->
                    <div class="mb-6">
                        <div class="border-b border-gray-200">
                            <nav class="flex space-x-8">
                                <button data-legal-tab="delivery" class="legal-tab-btn py-3 px-1 border-b-2 font-medium text-sm border-blue-600 text-blue-600">
                                    Politique de livraison
                                </button>
                                <button data-legal-tab="privacy" class="legal-tab-btn py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                                    Politique de confidentialité
                                </button>
                            </nav>
                        </div>
                    </div>
                    
                    <!-- Delivery Policy Tab -->
                    <div id="delivery-policy-tab" class="legal-tab-content">
                        <div class="bg-white rounded-xl shadow p-6">
                            <h2 class="text-lg font-semibold text-gray-900 mb-4">Politique de livraison</h2>
                            
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Introduction</label>
                                    <textarea id="delivery-intro" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">Notre politique de livraison a pour objectif de vous informer clairement sur les différentes options disponibles, les frais associés et les délais de livraison. Nous nous engageons à vous offrir une expérience de livraison transparente et fiable.</textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Modes de livraison</label>
                                    <textarea id="delivery-methods" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">Nous proposons trois modes de livraison :
• Livraison à domicile : Nous livrons directement à votre adresse dans un délai de 24 à 48h.
• Livraison par rencontre : Nous convenons d'un lieu de rendez-vous qui vous convient.
• Retrait en point de vente : Vous pouvez retirer votre commande dans l'un de nos points de vente partenaires.</textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Frais de livraison</label>
                                    <textarea id="delivery-fees" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">Les frais de livraison varient en fonction de plusieurs facteurs :
• Lieu de livraison : Les tarifs peuvent varier selon la distance et la zone géographique.
• Poids du colis : Les colis plus lourds peuvent engendrer des frais supplémentaires.
• Type de produit : Certains produits fragiles ou de grande valeur nécessitent un emballage et un transport spécialisés.</textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Code de livraison</label>
                                    <textarea id="delivery-code" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">Après validation de votre commande, vous recevez automatiquement un code de livraison unique. Ce code est obligatoire pour :
• Le retrait de votre commande en point de vente
• La livraison par rencontre
• L'identification de votre colis en cas de réclamation

Ce code sert de preuve que vous êtes bien l'auteur de la commande et doit être présenté lors du retrait ou de la livraison.</textarea>
                                </div>
                            </div>
                            
                            <div class="mt-8 pt-6 border-t">
                                <button id="save-delivery-policy" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
                                    <i class="fas fa-save mr-2"></i> Enregistrer la politique de livraison
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Privacy Policy Tab -->
                    <div id="privacy-policy-tab" class="legal-tab-content hidden">
                        <div class="bg-white rounded-xl shadow p-6">
                            <h2 class="text-lg font-semibold text-gray-900 mb-4">Politique de confidentialité</h2>
                            
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Introduction</label>
                                    <textarea id="privacy-intro" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">Chez IZIPRET, nous accordons une importance primordiale à la protection de vos données personnelles. Cette politique de confidentialité explique comment nous collectons, utilisons et protégeons vos informations lorsque vous utilisez notre site web et nos services.</textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Données collectées</label>
                                    <textarea id="privacy-data" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">Nous collectons uniquement les informations nécessaires au traitement de vos commandes et à l'amélioration de votre expérience :
• Informations de contact : nom, adresse email, numéro de téléphone, adresse de livraison.
• Informations de commande : produits achetés, quantités, modes de livraison et de paiement.
• Informations techniques : adresse IP, type de navigateur, pages consultées (pour l'analyse statistique).</textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Utilisation des données</label>
                                    <textarea id="privacy-usage" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">Vos données sont utilisées exclusivement pour :
• Traiter et livrer vos commandes
• Vous contacter concernant votre commande
• Améliorer nos services et votre expérience utilisateur
• Respecter nos obligations légales</textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Sécurité des données</label>
                                    <textarea id="privacy-security" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">Nous mettons en œuvre des mesures de sécurité techniques et organisationnelles appropriées pour protéger vos données contre tout accès non autorisé, modification, divulgation ou destruction. Vos données sont stockées de manière sécurisée sur les serveurs de Firebase (Google Cloud Platform), qui respectent les normes de sécurité les plus strictes.</textarea>
                                </div>
                            </div>
                            
                            <div class="mt-8 pt-6 border-t">
                                <button id="save-privacy-policy" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
                                    <i class="fas fa-save mr-2"></i> Enregistrer la politique de confidentialité
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>
    
    <!-- ========== MODALS ========== -->
    
    <!-- Product Modal -->
    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold" id="product-modal-title">Ajouter un produit</h3>
                    <button id="close-product-modal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <form id="product-form" class="space-y-6">
                    <!-- Basic Information -->
                    <div>
                        <h4 class="font-medium text-gray-900 mb-4">Informations de base</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Nom du produit *</label>
                                <input type="text" id="product-name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Catégorie *</label>
                                <input type="text" id="product-category" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Prix (€) *</label>
                                <input type="number" id="product-price" min="0" step="0.01" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Ancien prix (€)</label>
                                <input type="number" id="product-oldprice" min="0" step="0.01" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Stock *</label>
                                <input type="number" id="product-stock" min="0" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Description *</label>
                            <textarea id="product-description" rows="3" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nom de l'image *</label>
                            <input type="text" id="product-image" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="produit1.jpg">
                            <div class="mt-1 text-sm text-gray-500">Nom du fichier image (ex: produit1.jpg). Le fichier doit être uploadé manuellement sur GitHub.</div>
                        </div>
                    </div>
                    
                    <!-- Dynamic Options -->
                    <div>
                        <h4 class="font-medium text-gray-900 mb-4">Options dynamiques</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <label class="flex items-center">
                                <input type="checkbox" id="has-size" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-gray-700">Tailles</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="has-color" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-gray-700">Couleurs</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="has-personalization" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-gray-700">Personnalisation</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="has-material" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-gray-700">Matériaux</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="has-oz" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-gray-700">Options OZ</span>
                            </label>
                        </div>
                        
                        <!-- Options details (shown when checked) -->
                        <div id="options-details" class="mt-6 space-y-4 hidden">
                            <div id="size-options" class="hidden">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Tailles disponibles</label>
                                <input type="text" id="product-sizes" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="S, M, L, XL">
                                <div class="mt-1 text-sm text-gray-500">Séparez les tailles par des virgules</div>
                            </div>
                            
                            <div id="color-options" class="hidden">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Couleurs disponibles</label>
                                <input type="text" id="product-colors" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="Noir, Blanc, Rouge">
                                <div class="mt-1 text-sm text-gray-500">Séparez les couleurs par des virgules</div>
                            </div>
                            
                            <div id="personalization-options" class="hidden">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Label personnalisation</label>
                                        <input type="text" id="personalization-label" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="Texte à graver">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Caractères max</label>
                                        <input type="number" id="max-characters" min="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="20">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Logistics -->
                    <div>
                        <h4 class="font-medium text-gray-900 mb-4">Logistique</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Poids (kg) *</label>
                                <input type="number" id="product-weight" min="0" step="0.1" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Frais de livraison supplémentaires (€)</label>
                                <input type="number" id="extra-delivery-cost" min="0" step="0.01" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Modes de livraison autorisés</label>
                            <div class="flex flex-wrap gap-4">
                                <label class="flex items-center">
                                    <input type="checkbox" id="delivery-home" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                                    <span class="ml-2 text-gray-700">À domicile</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="delivery-meetup" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                                    <span class="ml-2 text-gray-700">Par rencontre</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="delivery-pickup" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                                    <span class="ml-2 text-gray-700">Point de vente</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="flex items-center">
                                <input type="checkbox" id="product-fragile" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-gray-700">Produit fragile</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Settings -->
                    <div>
                        <h4 class="font-medium text-gray-900 mb-4">Paramètres</h4>
                        <div class="flex flex-wrap gap-6">
                            <label class="flex items-center">
                                <input type="checkbox" id="product-available" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                                <span class="ml-2 text-gray-700">Produit disponible</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="show-in-hero" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-gray-700">Afficher dans le Hero</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Hidden fields -->
                    <input type="hidden" id="product-id">
                    
                    <div class="pt-6 border-t">
                        <div class="flex justify-end space-x-4">
                            <button type="button" id="cancel-product" class="px-6 py-2 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50">
                                Annuler
                            </button>
                            <button type="submit" id="save-product" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
                                Enregistrer le produit
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Location Modal -->
    <div id="location-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4">
            <div class="p-6 border-b">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold" id="location-modal-title">Ajouter un lieu de rencontre</h3>
                    <button id="close-location-modal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <form id="location-form" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nom du lieu *</label>
                        <input type="text" id="location-name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Tarif (€) *</label>
                        <input type="number" id="location-price" min="0" step="0.01" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                        <textarea id="location-description" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg"></textarea>
                    </div>
                    
                    <div>
                        <label class="flex items-center">
                            <input type="checkbox" id="location-active" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                            <span class="ml-2 text-gray-700">Lieu actif</span>
                        </label>
                    </div>
                    
                    <input type="hidden" id="location-id">
                    
                    <div class="pt-4">
                        <div class="flex justify-end space-x-4">
                            <button type="button" id="cancel-location" class="px-4 py-2 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50">
                                Annuler
                            </button>
                            <button type="submit" id="save-location" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
                                Enregistrer
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Order Details Modal -->
    <div id="order-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold" id="order-modal-title">Détails de la commande</h3>
                    <button id="close-order-modal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div id="order-details">
                    <!-- Order details will be loaded here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4">
            <div class="p-6">
                <div class="text-center">
                    <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-exclamation-triangle text-yellow-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-2" id="confirm-title">Confirmer la suppression</h3>
                    <p class="text-gray-600 mb-6" id="confirm-message">Êtes-vous sûr de vouloir supprimer cet élément ? Cette action est irréversible.</p>
                    
                    <div class="flex space-x-4">
                        <button id="confirm-cancel" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg font-medium hover:bg-gray-300 transition">
                            Annuler
                        </button>
                        <button id="confirm-action" class="flex-1 bg-red-600 text-white py-2 rounded-lg font-medium hover:bg-red-700 transition">
                            Confirmer
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Success Toast -->
    <div id="success-toast" class="fixed bottom-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-y-full transition-transform duration-300">
        <div class="flex items-center">
            <i class="fas fa-check-circle mr-3"></i>
            <span id="toast-message">Action réussie !</span>
        </div>
    </div>
    
    <!-- ========== FIREBASE CONFIGURATION ========== -->
    <script>
        // Configuration Firebase (identique au site client)
const firebaseConfig = {
  apiKey: "AIzaSyCOifibU2E6Vo-3Ohg-WmAHa43sa5HyFuw",
  authDomain: "smartcutservices.firebaseapp.com",
  projectId: "smartcutservices",
  storageBucket: "smartcutservices.firebasestorage.app",
  messagingSenderId: "589013273323",
  appId: "1:589013273323:web:415772e7b94f6bb37d8cae",
  measurementId: "G-R8GJXQP7BD"
};

        
        // Initialiser Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
    </script>
    
    <!-- ========== DASHBOARD APPLICATION ========== -->
    <script>
        // Variables globales
        let currentUser = null;
        let currentSection = 'products';
        let pendingOrdersCount = 0;
        let editingProductId = null;
        let editingLocationId = null;
        let products = [];
        let orders = [];
        let history = [];
        let meetupLocations = [];
        
        // Initialiser l'application
        document.addEventListener('DOMContentLoaded', function() {
            // Mettre à jour la date
            updateCurrentDate();
            
            // Vérifier l'état de connexion
            checkAuthState();
            
            // Gestionnaires d'événements pour le login
            document.getElementById('login-form').addEventListener('submit', handleLogin);
            
            // Gestionnaires pour la navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.getAttribute('data-section');
                    showSection(section);
                    
                    // Fermer le menu mobile
                    document.getElementById('sidebar').classList.remove('active');
                    document.getElementById('mobile-backdrop').classList.remove('active');
                });
            });
            
            // Gestionnaires pour les boutons du header
            document.getElementById('menu-toggle').addEventListener('click', function() {
                document.getElementById('sidebar').classList.add('active');
                document.getElementById('mobile-backdrop').classList.add('active');
            });
            
            document.getElementById('close-sidebar').addEventListener('click', function() {
                document.getElementById('sidebar').classList.remove('active');
                document.getElementById('mobile-backdrop').classList.remove('active');
            });
            
            document.getElementById('mobile-backdrop').addEventListener('click', function() {
                this.classList.remove('active');
                document.getElementById('sidebar').classList.remove('active');
            });
            
            document.getElementById('notifications-btn').addEventListener('click', function() {
                document.getElementById('notifications-dropdown').classList.toggle('hidden');
            });
            
            // Gestionnaire pour la déconnexion
            document.getElementById('logout-btn').addEventListener('click', handleLogout);
            
            // Gestionnaires pour les onglets de livraison
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tab = this.getAttribute('data-tab');
                    showDeliveryTab(tab);
                });
            });
            
            // Gestionnaires pour les onglets légaux
            document.querySelectorAll('.legal-tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tab = this.getAttribute('data-legal-tab');
                    showLegalTab(tab);
                });
            });
            
            // Gestionnaires pour les boutons d'action
            document.getElementById('add-product-btn').addEventListener('click', () => openProductModal());
            document.getElementById('add-location-btn').addEventListener('click', () => openLocationModal());
            document.getElementById('add-team-member').addEventListener('click', addTeamMember);
            
            // Gestionnaires pour les filtres de commandes
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const status = this.getAttribute('data-status');
                    filterOrders(status);
                });
            });
            
            // Gestionnaires pour les modales
            initModalHandlers();
            
            // Gestionnaires pour les formulaires
            document.getElementById('product-form').addEventListener('submit', saveProduct);
            document.getElementById('location-form').addEventListener('submit', saveLocation);
            document.getElementById('save-about').addEventListener('click', saveAboutContent);
            document.getElementById('save-delivery-policy').addEventListener('click', saveDeliveryPolicy);
            document.getElementById('save-privacy-policy').addEventListener('click', savePrivacyPolicy);
            
            // Options dynamiques des produits
            document.getElementById('has-size').addEventListener('change', toggleOptionFields);
            document.getElementById('has-color').addEventListener('change', toggleOptionFields);
            document.getElementById('has-personalization').addEventListener('change', toggleOptionFields);
            document.getElementById('has-material').addEventListener('change', toggleOptionFields);
            document.getElementById('has-oz').addEventListener('change', toggleOptionFields);
            
            // Fermer les dropdowns en cliquant à l'extérieur
            document.addEventListener('click', function(event) {
                const notificationsBtn = document.getElementById('notifications-btn');
                const notificationsDropdown = document.getElementById('notifications-dropdown');
                
                if (!notificationsBtn.contains(event.target) && !notificationsDropdown.contains(event.target)) {
                    notificationsDropdown.classList.add('hidden');
                }
            });
            
            // Mettre à jour la date toutes les minutes
            setInterval(updateCurrentDate, 60000);
        });
        
        // ========== AUTHENTIFICATION ==========
        function checkAuthState() {
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    showDashboard();
                    
                    // Charger les données après connexion
                    loadAllData();
                } else {
                    showLoginScreen();
                }
            });
        }
        
        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const errorElement = document.getElementById('login-error');
            
            // Afficher le chargement
            document.getElementById('loading-overlay').classList.remove('hidden');
            
            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    // Succès - géré par onAuthStateChanged
                })
                .catch(error => {
                    document.getElementById('loading-overlay').classList.add('hidden');
                    
                    let errorMessage = "Erreur de connexion";
                    switch(error.code) {
                        case 'auth/invalid-email':
                            errorMessage = "Adresse email invalide";
                            break;
                        case 'auth/user-disabled':
                            errorMessage = "Ce compte a été désactivé";
                            break;
                        case 'auth/user-not-found':
                        case 'auth/wrong-password':
                            errorMessage = "Email ou mot de passe incorrect";
                            break;
                    }
                    
                    document.getElementById('error-message').textContent = errorMessage;
                    errorElement.classList.remove('hidden');
                    
                    // Masquer l'erreur après 5 secondes
                    setTimeout(() => {
                        errorElement.classList.add('hidden');
                    }, 5000);
                });
        }
        
        function handleLogout() {
            auth.signOut()
                .then(() => {
                    showToast('Déconnexion réussie', 'success');
                })
                .catch(error => {
                    console.error('Erreur de déconnexion:', error);
                });
        }
        
        // ========== INTERFACE ==========
        function showLoginScreen() {
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('dashboard-container').classList.add('hidden');
        }
        
        function showDashboard() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('dashboard-container').classList.remove('hidden');
            document.getElementById('user-email').textContent = currentUser.email;
            
            // Mettre à jour le titre de la section active
            updateSectionTitle();
        }
        
        function showSection(sectionId) {
            // Cacher toutes les sections
            document.querySelectorAll('.dashboard-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Afficher la section sélectionnée
            document.getElementById(`${sectionId}-section`).classList.add('active');
            
            // Mettre à jour la navigation active
            document.querySelectorAll('.nav-item').forEach(item => {
                if (item.getAttribute('data-section') === sectionId) {
                    item.classList.add('bg-blue-50', 'text-blue-600');
                    item.classList.remove('text-gray-700');
                } else {
                    item.classList.remove('bg-blue-50', 'text-blue-600');
                    item.classList.add('text-gray-700');
                }
            });
            
            // Mettre à jour la variable et le titre
            currentSection = sectionId;
            updateSectionTitle();
            
            // Charger les données spécifiques à la section si nécessaire
            if (sectionId === 'products' && products.length === 0) {
                loadProducts();
            } else if (sectionId === 'orders' && orders.length === 0) {
                loadOrders();
            } else if (sectionId === 'history' && history.length === 0) {
                loadOrderHistory();
            } else if (sectionId === 'delivery' && meetupLocations.length === 0) {
                loadMeetupLocations();
            }
        }
        
        function updateSectionTitle() {
            const titles = {
                'products': 'Gestion Produits',
                'delivery': 'Livraison & Logistique',
                'orders': 'Commandes',
                'history': 'Historique des Commandes',
                'about': 'Page "À propos"',
                'legal': 'Pages Légales'
            };
            
            document.getElementById('section-title').textContent = titles[currentSection] || 'Dashboard';
        }
        
        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            document.getElementById('current-date').textContent = now.toLocaleDateString('fr-FR', options);
        }
        
        function showDeliveryTab(tabId) {
            // Mettre à jour les onglets actifs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.getAttribute('data-tab') === tabId) {
                    btn.classList.add('border-blue-600', 'text-blue-600');
                    btn.classList.remove('border-transparent', 'text-gray-500');
                } else {
                    btn.classList.remove('border-blue-600', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-gray-500');
                }
            });
            
            // Afficher le contenu de l'onglet
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${tabId}-tab`).classList.remove('hidden');
        }
        
        function showLegalTab(tabId) {
            // Mettre à jour les onglets actifs
            document.querySelectorAll('.legal-tab-btn').forEach(btn => {
                if (btn.getAttribute('data-legal-tab') === tabId) {
                    btn.classList.add('border-blue-600', 'text-blue-600');
                    btn.classList.remove('border-transparent', 'text-gray-500');
                } else {
                    btn.classList.remove('border-blue-600', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-gray-500');
                }
            });
            
            // Afficher le contenu de l'onglet
            document.querySelectorAll('.legal-tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${tabId}-policy-tab`).classList.remove('hidden');
        }
        
        function filterOrders(status) {
            // Mettre à jour les boutons actifs
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.getAttribute('data-status') === status) {
                    btn.classList.add('bg-blue-600', 'text-white');
                    btn.classList.remove('bg-gray-200', 'text-gray-700');
                } else {
                    btn.classList.remove('bg-blue-600', 'text-white');
                    btn.classList.add('bg-gray-200', 'text-gray-700');
                }
            });
            
            // Filtrer les commandes (implémentation simplifiée)
            // Dans une vraie application, on rechargerait depuis Firestore
        }
        
        // ========== MODALES ==========
        function initModalHandlers() {
            // Product modal
            document.getElementById('close-product-modal').addEventListener('click', () => {
                document.getElementById('product-modal').classList.add('hidden');
            });
            
            document.getElementById('cancel-product').addEventListener('click', () => {
                document.getElementById('product-modal').classList.add('hidden');
            });
            
            // Location modal
            document.getElementById('close-location-modal').addEventListener('click', () => {
                document.getElementById('location-modal').classList.add('hidden');
            });
            
            document.getElementById('cancel-location').addEventListener('click', () => {
                document.getElementById('location-modal').classList.add('hidden');
            });
            
            // Order modal
            document.getElementById('close-order-modal').addEventListener('click', () => {
                document.getElementById('order-modal').classList.add('hidden');
            });
            
            // Confirmation modal
            document.getElementById('confirm-cancel').addEventListener('click', () => {
                document.getElementById('confirm-modal').classList.add('hidden');
            });
        }
        
        function openProductModal(product = null) {
            const modal = document.getElementById('product-modal');
            const title = document.getElementById('product-modal-title');
            const form = document.getElementById('product-form');
            
            if (product) {
                // Mode édition
                title.textContent = 'Modifier le produit';
                editingProductId = product.id;
                
                // Remplir le formulaire
                document.getElementById('product-id').value = product.id;
                document.getElementById('product-name').value = product.name || '';
                document.getElementById('product-category').value = product.category || '';
                document.getElementById('product-price').value = product.price || '';
                document.getElementById('product-oldprice').value = product.oldPrice || '';
                document.getElementById('product-stock').value = product.stock || 0;
                document.getElementById('product-description').value = product.description || '';
                document.getElementById('product-image').value = product.imageName || '';
                document.getElementById('product-weight').value = product.weight || 0;
                document.getElementById('extra-delivery-cost').value = product.extraDeliveryCost || 0;
                document.getElementById('product-fragile').checked = product.fragile || false;
                document.getElementById('product-available').checked = product.isAvailable !== false;
                document.getElementById('show-in-hero').checked = product.showInHero || false;
                
                // Options dynamiques
                document.getElementById('has-size').checked = product.hasSize || false;
                document.getElementById('has-color').checked = product.hasColor || false;
                document.getElementById('has-personalization').checked = product.hasPersonalizationText || false;
                document.getElementById('has-material').checked = product.hasMaterial || false;
                document.getElementById('has-oz').checked = product.hasOz || false;
                
                // Valeurs des options
                document.getElementById('product-sizes').value = product.sizes ? product.sizes.join(', ') : '';
                document.getElementById('product-colors').value = product.colors ? product.colors.join(', ') : '';
                document.getElementById('personalization-label').value = product.personalizationLabel || '';
                document.getElementById('max-characters').value = product.maxCharacters || '';
                
                // Modes de livraison
                const deliveryLogic = product.deliveryLogic || [];
                document.getElementById('delivery-home').checked = deliveryLogic.includes('domicile');
                document.getElementById('delivery-meetup').checked = deliveryLogic.includes('rencontre');
                document.getElementById('delivery-pickup').checked = deliveryLogic.includes('point de vente');
                
                // Afficher les champs d'options si nécessaire
                toggleOptionFields();
            } else {
                // Mode création
                title.textContent = 'Ajouter un produit';
                editingProductId = null;
                form.reset();
                
                // Valeurs par défaut
                document.getElementById('product-available').checked = true;
                document.getElementById('delivery-home').checked = true;
                document.getElementById('delivery-meetup').checked = true;
                document.getElementById('delivery-pickup').checked = true;
                
                // Cacher les options dynamiques
                document.getElementById('options-details').classList.add('hidden');
                document.querySelectorAll('#options-details > div').forEach(div => {
                    div.classList.add('hidden');
                });
            }
            
            modal.classList.remove('hidden');
        }
        
        function openLocationModal(location = null) {
            const modal = document.getElementById('location-modal');
            const title = document.getElementById('location-modal-title');
            const form = document.getElementById('location-form');
            
            if (location) {
                // Mode édition
                title.textContent = 'Modifier le lieu';
                editingLocationId = location.id;
                
                // Remplir le formulaire
                document.getElementById('location-id').value = location.id;
                document.getElementById('location-name').value = location.name || '';
                document.getElementById('location-price').value = location.price || '';
                document.getElementById('location-description').value = location.description || '';
                document.getElementById('location-active').checked = location.active !== false;
            } else {
                // Mode création
                title.textContent = 'Ajouter un lieu de rencontre';
                editingLocationId = null;
                form.reset();
                document.getElementById('location-active').checked = true;
            }
            
            modal.classList.remove('hidden');
        }
        
        function openOrderModal(order) {
            const modal = document.getElementById('order-modal');
            const title = document.getElementById('order-modal-title');
            const details = document.getElementById('order-details');
            
            title.textContent = `Commande ${order.code}`;
            
            // Formater la date
            const orderDate = order.date ? new Date(order.date.seconds * 1000) : new Date();
            const formattedDate = orderDate.toLocaleDateString('fr-FR', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Déterminer le statut
            let statusText = 'En attente';
            let statusClass = 'status-pending';
            if (order.status === 'validated') {
                statusText = 'Validée';
                statusClass = 'status-validated';
            } else if (order.status === 'delivered') {
                statusText = 'Livrée';
                statusClass = 'status-delivered';
            }
            
            // Déterminer le mode de paiement
            const paymentMethod = order.paymentMethod === 'moncash' ? 'MonCash' : 'Paiement à la rencontre';
            
            // Déterminer le mode de livraison
            let deliveryMethod = '';
            switch(order.deliveryMethod) {
                case 'home': deliveryMethod = 'Livraison à domicile'; break;
                case 'meetup': deliveryMethod = 'Livraison par rencontre'; break;
                case 'pickup': deliveryMethod = 'Retrait en point de vente'; break;
                default: deliveryMethod = order.deliveryMethod || 'Non spécifié';
            }
            
            // Générer le HTML des produits
            let productsHTML = '';
            if (order.items && order.items.length > 0) {
                order.items.forEach(item => {
                    productsHTML += `
                        <div class="flex items-center justify-between py-3 border-b">
                            <div>
                                <div class="font-medium">${item.name}</div>
                                <div class="text-sm text-gray-500">
                                    ${item.quantity} × ${item.price}€
                                    ${item.options ? ` • ${Object.values(item.options).join(', ')}` : ''}
                                </div>
                            </div>
                            <div class="font-semibold">${(item.quantity * item.price).toFixed(2)}€</div>
                        </div>
                    `;
                });
            }
            
            details.innerHTML = `
                <div class="space-y-6">
                    <!-- Informations de base -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-medium text-gray-900 mb-2">Informations client</h4>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <p><strong>Code:</strong> ${order.code}</p>
                                <p><strong>Date:</strong> ${formattedDate}</p>
                                ${order.customerName ? `<p><strong>Client:</strong> ${order.customerName}</p>` : ''}
                                ${order.customerContact ? `<p><strong>Contact:</strong> ${order.customerContact}</p>` : ''}
                                ${order.deliveryAddress ? `<p><strong>Adresse:</strong> ${order.deliveryAddress}</p>` : ''}
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-medium text-gray-900 mb-2">Détails de la commande</h4>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <p><strong>Statut:</strong> <span class="${statusClass} status-badge">${statusText}</span></p>
                                <p><strong>Paiement:</strong> ${paymentMethod}</p>
                                <p><strong>Livraison:</strong> ${deliveryMethod}</p>
                                <p><strong>Total:</strong> <span class="font-bold text-lg">${order.total ? order.total.toFixed(2) : '0.00'}€</span></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Produits commandés -->
                    <div>
                        <h4 class="font-medium text-gray-900 mb-2">Produits commandés</h4>
                        <div class="bg-gray-50 rounded-lg overflow-hidden">
                            ${productsHTML || '<p class="p-4 text-center text-gray-500">Aucun produit</p>'}
                            <div class="flex justify-between items-center p-4 bg-gray-100">
                                <span class="font-semibold">Total</span>
                                <span class="font-bold text-xl">${order.total ? order.total.toFixed(2) : '0.00'}€</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Actions -->
                    ${order.status !== 'delivered' ? `
                    <div class="pt-6 border-t">
                        <div class="flex justify-end space-x-4">
                            ${order.status === 'pending' ? `
                            <button class="validate-order-btn bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition" data-order-id="${order.id}">
                                <i class="fas fa-check mr-2"></i> Valider la commande
                            </button>
                            ` : ''}
                            
                            <button class="deliver-order-btn bg-green-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-green-700 transition" data-order-id="${order.id}">
                                <i class="fas fa-truck mr-2"></i> Marquer comme livrée
                            </button>
                        </div>
                    </div>
                    ` : ''}
                </div>
            `;
            
            // Ajouter les gestionnaires d'événements pour les boutons
            const validateBtn = details.querySelector('.validate-order-btn');
            if (validateBtn) {
                validateBtn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-order-id');
                    updateOrderStatus(orderId, 'validated');
                });
            }
            
            const deliverBtn = details.querySelector('.deliver-order-btn');
            if (deliverBtn) {
                deliverBtn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-order-id');
                    updateOrderStatus(orderId, 'delivered');
                });
            }
            
            modal.classList.remove('hidden');
        }
        
        function showConfirmModal(title, message, actionCallback) {
            document.getElementById('confirm-title').textContent = title;
            document.getElementById('confirm-message').textContent = message;
            
            const confirmBtn = document.getElementById('confirm-action');
            const newConfirmBtn = confirmBtn.cloneNode(true);
            confirmBtn.parentNode.replaceChild(newConfirmBtn, confirmBtn);
            
            newConfirmBtn.addEventListener('click', function() {
                actionCallback();
                document.getElementById('confirm-modal').classList.add('hidden');
            });
            
            document.getElementById('confirm-modal').classList.remove('hidden');
        }
        
        function toggleOptionFields() {
            const optionsDetails = document.getElementById('options-details');
            let hasOptions = false;
            
            // Tailles
            const hasSize = document.getElementById('has-size').checked;
            document.getElementById('size-options').classList.toggle('hidden', !hasSize);
            if (hasSize) hasOptions = true;
            
            // Couleurs
            const hasColor = document.getElementById('has-color').checked;
            document.getElementById('color-options').classList.toggle('hidden', !hasColor);
            if (hasColor) hasOptions = true;
            
            // Personnalisation
            const hasPersonalization = document.getElementById('has-personalization').checked;
            document.getElementById('personalization-options').classList.toggle('hidden', !hasPersonalization);
            if (hasPersonalization) hasOptions = true;
            
            // Afficher/masquer la section des options
            optionsDetails.classList.toggle('hidden', !hasOptions);
        }
        
        // ========== FIREBASE DATA ==========
        function loadAllData() {
            loadProducts();
            loadOrders();
            loadMeetupLocations();
        }
        
        async function loadProducts() {
            try {
                // Dans une vraie application, on chargerait depuis Firestore
                // Pour cette démo, on utilise des données simulées
                
                // Simuler un délai de chargement
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Données simulées (identique au site client)
                products = [
                    {
                        id: '1',
                        name: 'Casque Audio Premium',
                        price: 129.99,
                        oldPrice: 159.99,
                        description: 'Casque audio sans fil avec réduction de bruit active',
                        imageName: 'casque.jpg',
                        category: 'Électronique',
                        stock: 15,
                        isAvailable: true,
                        showInHero: true,
                        hasSize: false,
                        hasColor: true,
                        colors: ['Noir', 'Blanc', 'Bleu'],
                        weight: 0.5,
                        fragile: true,
                        deliveryLogic: ['domicile', 'rencontre', 'point de vente']
                    },
                    {
                        id: '2',
                        name: 'Montre Connectée',
                        price: 199.99,
                        description: 'Montre intelligente avec suivi d\'activité et notifications',
                        imageName: 'montre.jpg',
                        category: 'Électronique',
                        stock: 8,
                        isAvailable: true,
                        showInHero: true,
                        hasSize: true,
                        sizes: ['S', 'M', 'L'],
                        weight: 0.1,
                        deliveryLogic: ['domicile', 'rencontre']
                    }
                ];
                
                displayProducts();
                updateProductStats();
                
            } catch (error) {
                console.error('Erreur lors du chargement des produits:', error);
                showToast('Erreur de chargement des produits', 'error');
            }
        }
        
        async function loadOrders() {
            try {
                // Données simulées
                orders = [
                    {
                        id: 'ORD-001',
                        code: 'IZP-123456',
                        customerName: 'Jean Dupont',
                        customerContact: 'jean@email.com',
                        date: { seconds: Date.now() / 1000 - 3600 }, // 1 heure avant
                        items: [
                            { name: 'Casque Audio Premium', price: 129.99, quantity: 1 },
                            { name: 'Montre Connectée', price: 199.99, quantity: 1 }
                        ],
                        total: 329.98,
                        paymentMethod: 'moncash',
                        deliveryMethod: 'home',
                        status: 'pending',
                        deliveryAddress: '123 Rue Commerce, Port-au-Prince'
                    },
                    {
                        id: 'ORD-002',
                        code: 'IZP-789012',
                        customerName: 'Marie Martin',
                        customerContact: '+509 1234 5678',
                        date: { seconds: Date.now() / 1000 - 7200 }, // 2 heures avant
                        items: [
                            { name: 'Sac à Dos Urbain', price: 59.99, quantity: 2 }
                        ],
                        total: 119.98,
                        paymentMethod: 'meetup',
                        deliveryMethod: 'meetup',
                        status: 'validated'
                    }
                ];
                
                pendingOrdersCount = orders.filter(order => order.status === 'pending').length;
                updateOrdersBadge();
                displayOrders();
                
            } catch (error) {
                console.error('Erreur lors du chargement des commandes:', error);
            }
        }
        
        async function loadOrderHistory() {
            try {
                // Données simulées
                history = [
                    {
                        id: 'ORD-003',
                        code: 'IZP-345678',
                        customerName: 'Pierre Durand',
                        date: { seconds: Date.now() / 1000 - 86400 }, // 1 jour avant
                        total: 49.99,
                        paymentMethod: 'moncash',
                        deliveryMethod: 'pickup',
                        status: 'delivered'
                    },
                    {
                        id: 'ORD-004',
                        code: 'IZP-901234',
                        customerName: 'Sophie Bernard',
                        date: { seconds: Date.now() / 1000 - 172800 }, // 2 jours avant
                        total: 199.99,
                        paymentMethod: 'meetup',
                        deliveryMethod: 'home',
                        status: 'delivered'
                    }
                ];
                
                displayOrderHistory();
                
            } catch (error) {
                console.error('Erreur lors du chargement de l\'historique:', error);
            }
        }
        
        async function loadMeetupLocations() {
            try {
                // Données simulées
                meetupLocations = [
                    {
                        id: '1',
                        name: 'Centre-ville',
                        price: 5.00,
                        description: 'Devant la mairie',
                        active: true
                    },
                    {
                        id: '2',
                        name: 'Gare principale',
                        price: 7.00,
                        description: 'Sortie nord',
                        active: true
                    },
                    {
                        id: '3',
                        name: 'Centre commercial',
                        price: 4.50,
                        description: 'Parking principal',
                        active: false
                    }
                ];
                
                displayMeetupLocations();
                
            } catch (error) {
                console.error('Erreur lors du chargement des lieux:', error);
            }
        }
        
        // ========== AFFICHAGE DES DONNÉES ==========
        function displayProducts() {
            const tbody = document.getElementById('products-table-body');
            
            if (products.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="px-6 py-12 text-center">
                            <i class="fas fa-box-open text-4xl text-gray-300 mb-4"></i>
                            <p class="text-gray-500">Aucun produit trouvé</p>
                            <button id="add-first-product" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
                                Ajouter votre premier produit
                            </button>
                        </td>
                    </tr>
                `;
                
                document.getElementById('add-first-product').addEventListener('click', () => openProductModal());
                return;
            }
            
            tbody.innerHTML = '';
            
            products.forEach(product => {
                const row = document.createElement('tr');
                
                // Statut
                let statusHTML = '';
                if (product.isAvailable) {
                    statusHTML = '<span class="status-badge status-delivered">Actif</span>';
                } else {
                    statusHTML = '<span class="status-badge status-pending">Inactif</span>';
                }
                
                // Actions
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="flex items-center">
                            <div class="h-10 w-10 flex-shrink-0">
                                <div class="h-10 w-10 rounded-lg bg-gray-200 flex items-center justify-center">
                                    <i class="fas fa-box text-gray-500"></i>
                                </div>
                            </div>
                            <div class="ml-4">
                                <div class="font-medium text-gray-900">${product.name}</div>
                                <div class="text-sm text-gray-500">${product.category}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-900">${product.category}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm font-semibold text-gray-900">${product.price}€</div>
                        ${product.oldPrice ? `<div class="text-xs text-gray-500 line-through">${product.oldPrice}€</div>` : ''}
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm ${product.stock > 10 ? 'text-green-600' : 'text-orange-600'}">
                            ${product.stock} unités
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        ${statusHTML}
                        ${product.showInHero ? '<div class="text-xs text-blue-600 mt-1">Dans Hero</div>' : ''}
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2">
                            <button class="edit-product text-blue-600 hover:text-blue-800" data-id="${product.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="delete-product text-red-600 hover:text-red-800" data-id="${product.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            // Ajouter les gestionnaires d'événements
            document.querySelectorAll('.edit-product').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const product = products.find(p => p.id === productId);
                    if (product) openProductModal(product);
                });
            });
            
            document.querySelectorAll('.delete-product').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const product = products.find(p => p.id === productId);
                    
                    if (product) {
                        showConfirmModal(
                            'Supprimer le produit',
                            `Êtes-vous sûr de vouloir supprimer "${product.name}" ? Cette action est irréversible.`,
                            () => deleteProduct(productId)
                        );
                    }
                });
            });
        }
        
        function displayOrders() {
            const container = document.getElementById('orders-container');
            
            if (orders.length === 0) {
                container.innerHTML = `
                    <div class="col-span-2 text-center py-12">
                        <i class="fas fa-shopping-cart text-4xl text-gray-300 mb-4"></i>
                        <p class="text-gray-500">Aucune commande en attente</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            
            orders.forEach(order => {
                // Formater la date
                const orderDate = order.date ? new Date(order.date.seconds * 1000) : new Date();
                const formattedDate = orderDate.toLocaleDateString('fr-FR', {
                    day: 'numeric',
                    month: 'short',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // Déterminer le statut
                let statusText = 'En attente';
                let statusClass = 'status-pending';
                if (order.status === 'validated') {
                    statusText = 'Validée';
                    statusClass = 'status-validated';
                } else if (order.status === 'delivered') {
                    statusText = 'Livrée';
                    statusClass = 'status-delivered';
                }
                
                // Nombre d'articles
                const itemCount = order.items ? order.items.reduce((sum, item) => sum + item.quantity, 0) : 0;
                
                const card = document.createElement('div');
                card.className = 'bg-white rounded-xl shadow p-6';
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="font-semibold text-gray-900">${order.code}</h3>
                            <p class="text-sm text-gray-500">${formattedDate}</p>
                        </div>
                        <span class="${statusClass} status-badge">${statusText}</span>
                    </div>
                    
                    <div class="mb-4">
                        <p class="text-gray-700"><strong>Client:</strong> ${order.customerName || 'Non spécifié'}</p>
                        <p class="text-gray-700"><strong>Contact:</strong> ${order.customerContact || 'Non spécifié'}</p>
                        ${order.deliveryAddress ? `<p class="text-gray-700 text-sm mt-1"><strong>Adresse:</strong> ${order.deliveryAddress}</p>` : ''}
                    </div>
                    
                    <div class="mb-6">
                        <p class="text-gray-700"><strong>Articles:</strong> ${itemCount} produit(s)</p>
                        <p class="text-gray-700"><strong>Total:</strong> <span class="font-bold">${order.total ? order.total.toFixed(2) : '0.00'}€</span></p>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <button class="view-order-details text-blue-600 hover:text-blue-800 font-medium" data-order-id="${order.id}">
                            <i class="fas fa-eye mr-1"></i> Voir détails
                        </button>
                        
                        ${order.status !== 'delivered' ? `
                        <div class="flex space-x-2">
                            ${order.status === 'pending' ? `
                            <button class="validate-order-btn bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition" data-order-id="${order.id}">
                                Valider
                            </button>
                            ` : ''}
                            
                            <button class="deliver-order-btn bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition" data-order-id="${order.id}">
                                Livrer
                            </button>
                        </div>
                        ` : ''}
                    </div>
                `;
                
                container.appendChild(card);
            });
            
            // Ajouter les gestionnaires d'événements
            document.querySelectorAll('.view-order-details').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-order-id');
                    const order = orders.find(o => o.id === orderId);
                    if (order) openOrderModal(order);
                });
            });
            
            document.querySelectorAll('.validate-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-order-id');
                    updateOrderStatus(orderId, 'validated');
                });
            });
            
            document.querySelectorAll('.deliver-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-order-id');
                    updateOrderStatus(orderId, 'delivered');
                });
            });
        }
        
        function displayOrderHistory() {
            const tbody = document.getElementById('history-table-body');
            
            if (history.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="px-6 py-12 text-center">
                            <i class="fas fa-history text-4xl text-gray-300 mb-4"></i>
                            <p class="text-gray-500">Aucun historique de commandes</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = '';
            
            const allOrders = [...orders, ...history];
            
            allOrders.forEach(order => {
                const row = document.createElement('tr');
                
                // Formater la date
                const orderDate = order.date ? new Date(order.date.seconds * 1000) : new Date();
                const formattedDate = orderDate.toLocaleDateString('fr-FR');
                
                // Déterminer le statut
                let statusText = 'En attente';
                let statusClass = 'status-pending';
                if (order.status === 'validated') {
                    statusText = 'Validée';
                    statusClass = 'status-validated';
                } else if (order.status === 'delivered') {
                    statusText = 'Livrée';
                    statusClass = 'status-delivered';
                }
                
                // Déterminer le mode de paiement
                const paymentMethod = order.paymentMethod === 'moncash' ? 'MonCash' : 'Rencontre';
                
                // Déterminer le mode de livraison
                let deliveryMethod = '';
                switch(order.deliveryMethod) {
                    case 'home': deliveryMethod = 'Domicile'; break;
                    case 'meetup': deliveryMethod = 'Rencontre'; break;
                    case 'pickup': deliveryMethod = 'Point de vente'; break;
                    default: deliveryMethod = order.deliveryMethod || '-';
                }
                
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="text-sm font-medium text-gray-900">${order.code}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-900">${order.customerName || '-'}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-500">
                            ${order.items ? order.items.length : 0} article(s)
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm font-semibold text-gray-900">${order.total ? order.total.toFixed(2) : '0.00'}€</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-900">${paymentMethod}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-900">${deliveryMethod}</div>
                    </td>
                    <td class="px-6 py-4">
                        <span class="${statusClass} status-badge">${statusText}</span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-500">${formattedDate}</div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        function displayMeetupLocations() {
            const tbody = document.getElementById('locations-table-body');
            
            if (meetupLocations.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="px-6 py-12 text-center">
                            <p class="text-gray-500">Aucun lieu configuré</p>
                            <button id="add-first-location" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
                                Ajouter votre premier lieu
                            </button>
                        </td>
                    </tr>
                `;
                
                document.getElementById('add-first-location').addEventListener('click', () => openLocationModal());
                return;
            }
            
            tbody.innerHTML = '';
            
            meetupLocations.forEach(location => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="font-medium text-gray-900">${location.name}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm font-semibold text-gray-900">${location.price}€</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-500">${location.description || '-'}</div>
                    </td>
                    <td class="px-6 py-4">
                        ${location.active ? 
                            '<span class="status-badge status-delivered">Actif</span>' : 
                            '<span class="status-badge status-pending">Inactif</span>'}
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2">
                            <button class="edit-location text-blue-600 hover:text-blue-800" data-id="${location.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="delete-location text-red-600 hover:text-red-800" data-id="${location.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            // Ajouter les gestionnaires d'événements
            document.querySelectorAll('.edit-location').forEach(btn => {
                btn.addEventListener('click', function() {
                    const locationId = this.getAttribute('data-id');
                    const location = meetupLocations.find(l => l.id === locationId);
                    if (location) openLocationModal(location);
                });
            });
            
            document.querySelectorAll('.delete-location').forEach(btn => {
                btn.addEventListener('click', function() {
                    const locationId = this.getAttribute('data-id');
                    const location = meetupLocations.find(l => l.id === locationId);
                    
                    if (location) {
                        showConfirmModal(
                            'Supprimer le lieu',
                            `Êtes-vous sûr de vouloir supprimer "${location.name}" ?`,
                            () => deleteLocation(locationId)
                        );
                    }
                });
            });
        }
        
        function updateProductStats() {
            const totalProducts = products.length;
            const activeProducts = products.filter(p => p.isAvailable).length;
            const heroProducts = products.filter(p => p.showInHero).length;
            
            document.getElementById('total-products').textContent = totalProducts;
            document.getElementById('active-products').textContent = activeProducts;
            document.getElementById('hero-products').textContent = heroProducts;
        }
        
        function updateOrdersBadge() {
            const ordersBadge = document.getElementById('orders-badge');
            const notificationBadge = document.getElementById('notification-badge');
            
            if (pendingOrdersCount > 0) {
                ordersBadge.textContent = pendingOrdersCount;
                ordersBadge.classList.remove('hidden');
                
                notificationBadge.textContent = pendingOrdersCount;
                notificationBadge.classList.remove('hidden');
            } else {
                ordersBadge.classList.add('hidden');
                notificationBadge.classList.add('hidden');
            }
        }
        
        // ========== GESTION DES DONNÉES ==========
        async function saveProduct(e) {
            e.preventDefault();
            
            // Récupérer les données du formulaire
            const productData = {
                name: document.getElementById('product-name').value,
                category: document.getElementById('product-category').value,
                price: parseFloat(document.getElementById('product-price').value),
                oldPrice: document.getElementById('product-oldprice').value ? parseFloat(document.getElementById('product-oldprice').value) : null,
                stock: parseInt(document.getElementById('product-stock').value),
                description: document.getElementById('product-description').value,
                imageName: document.getElementById('product-image').value,
                weight: parseFloat(document.getElementById('product-weight').value),
                extraDeliveryCost: document.getElementById('extra-delivery-cost').value ? parseFloat(document.getElementById('extra-delivery-cost').value) : 0,
                fragile: document.getElementById('product-fragile').checked,
                isAvailable: document.getElementById('product-available').checked,
                showInHero: document.getElementById('show-in-hero').checked,
                
                // Options dynamiques
                hasSize: document.getElementById('has-size').checked,
                hasColor: document.getElementById('has-color').checked,
                hasPersonalizationText: document.getElementById('has-personalization').checked,
                hasMaterial: document.getElementById('has-material').checked,
                hasOz: document.getElementById('has-oz').checked,
                
                // Modes de livraison
                deliveryLogic: []
            };
            
            // Ajouter les modes de livraison
            if (document.getElementById('delivery-home').checked) productData.deliveryLogic.push('domicile');
            if (document.getElementById('delivery-meetup').checked) productData.deliveryLogic.push('rencontre');
            if (document.getElementById('delivery-pickup').checked) productData.deliveryLogic.push('point de vente');
            
            // Ajouter les valeurs des options si activées
            if (productData.hasSize) {
                productData.sizes = document.getElementById('product-sizes').value
                    .split(',')
                    .map(s => s.trim())
                    .filter(s => s);
            }
            
            if (productData.hasColor) {
                productData.colors = document.getElementById('product-colors').value
                    .split(',')
                    .map(c => c.trim())
                    .filter(c => c);
            }
            
            if (productData.hasPersonalizationText) {
                productData.personalizationLabel = document.getElementById('personalization-label').value;
                productData.maxCharacters = parseInt(document.getElementById('max-characters').value) || 20;
            }
            
            try {
                // Dans une vraie application, on sauvegarderait dans Firestore
                const productId = editingProductId || 'prod_' + Date.now();
                
                if (editingProductId) {
                    // Mettre à jour le produit existant
                    const index = products.findIndex(p => p.id === editingProductId);
                    if (index !== -1) {
                        products[index] = { ...products[index], ...productData, id: productId };
                    }
                    showToast('Produit modifié avec succès', 'success');
                } else {
                    // Ajouter un nouveau produit
                    productData.id = productId;
                    products.push(productData);
                    showToast('Produit ajouté avec succès', 'success');
                }
                
                // Mettre à jour l'affichage
                displayProducts();
                updateProductStats();
                
                // Fermer la modale
                document.getElementById('product-modal').classList.add('hidden');
                
                // Réinitialiser le formulaire
                document.getElementById('product-form').reset();
                editingProductId = null;
                
            } catch (error) {
                console.error('Erreur lors de la sauvegarde du produit:', error);
                showToast('Erreur lors de la sauvegarde', 'error');
            }
        }
        
        async function saveLocation(e) {
            e.preventDefault();
            
            const locationData = {
                name: document.getElementById('location-name').value,
                price: parseFloat(document.getElementById('location-price').value),
                description: document.getElementById('location-description').value,
                active: document.getElementById('location-active').checked
            };
            
            try {
                const locationId = editingLocationId || 'loc_' + Date.now();
                
                if (editingLocationId) {
                    // Mettre à jour le lieu existant
                    const index = meetupLocations.findIndex(l => l.id === editingLocationId);
                    if (index !== -1) {
                        meetupLocations[index] = { ...meetupLocations[index], ...locationData, id: locationId };
                    }
                    showToast('Lieu modifié avec succès', 'success');
                } else {
                    // Ajouter un nouveau lieu
                    locationData.id = locationId;
                    meetupLocations.push(locationData);
                    showToast('Lieu ajouté avec succès', 'success');
                }
                
                // Mettre à jour l'affichage
                displayMeetupLocations();
                
                // Fermer la modale
                document.getElementById('location-modal').classList.add('hidden');
                
                // Réinitialiser le formulaire
                document.getElementById('location-form').reset();
                editingLocationId = null;
                
            } catch (error) {
                console.error('Erreur lors de la sauvegarde du lieu:', error);
                showToast('Erreur lors de la sauvegarde', 'error');
            }
        }
        
        async function deleteProduct(productId) {
            try {
                // Filtrer le produit supprimé
                products = products.filter(p => p.id !== productId);
                
                // Mettre à jour l'affichage
                displayProducts();
                updateProductStats();
                
                showToast('Produit supprimé avec succès', 'success');
                
            } catch (error) {
                console.error('Erreur lors de la suppression du produit:', error);
                showToast('Erreur lors de la suppression', 'error');
            }
        }
        
        async function deleteLocation(locationId) {
            try {
                // Filtrer le lieu supprimé
                meetupLocations = meetupLocations.filter(l => l.id !== locationId);
                
                // Mettre à jour l'affichage
                displayMeetupLocations();
                
                showToast('Lieu supprimé avec succès', 'success');
                
            } catch (error) {
                console.error('Erreur lors de la suppression du lieu:', error);
                showToast('Erreur lors de la suppression', 'error');
            }
        }
        
        async function updateOrderStatus(orderId, newStatus) {
            try {
                // Trouver la commande
                const orderIndex = orders.findIndex(o => o.id === orderId);
                if (orderIndex === -1) return;
                
                // Mettre à jour le statut
                orders[orderIndex].status = newStatus;
                
                // Si la commande est livrée, l'ajouter à l'historique
                if (newStatus === 'delivered') {
                    history.push(orders[orderIndex]);
                    orders.splice(orderIndex, 1);
                    
                    // Mettre à jour le compteur de commandes en attente
                    pendingOrdersCount = orders.filter(o => o.status === 'pending').length;
                    updateOrdersBadge();
                    
                    showToast('Commande marquée comme livrée', 'success');
                } else if (newStatus === 'validated') {
                    showToast('Commande validée', 'success');
                }
                
                // Mettre à jour l'affichage
                displayOrders();
                
                // Fermer la modale des détails si ouverte
                document.getElementById('order-modal').classList.add('hidden');
                
            } catch (error) {
                console.error('Erreur lors de la mise à jour du statut:', error);
                showToast('Erreur lors de la mise à jour', 'error');
            }
        }
        
        async function saveAboutContent() {
            try {
                // Récupérer les données
                const aboutData = {
                    companyStory: document.getElementById('company-story').value,
                    ceoName: document.getElementById('ceo-name').value,
                    ceoRole: document.getElementById('ceo-role').value,
                    ceoDescription: document.getElementById('ceo-description').value,
                    ceoImage: document.getElementById('ceo-image').value,
                    teamMembers: []
                };
                
                // Récupérer les membres de l'équipe
                document.querySelectorAll('.team-member').forEach(member => {
                    aboutData.teamMembers.push({
                        name: member.querySelector('.team-name').value,
                        role: member.querySelector('.team-role').value,
                        description: member.querySelector('.team-description').value,
                        image: member.querySelector('.team-image').value
                    });
                });
                
                // Dans une vraie application, on sauvegarderait dans Firestore
                console.log('Données About sauvegardées:', aboutData);
                
                showToast('Contenu About sauvegardé avec succès', 'success');
                
            } catch (error) {
                console.error('Erreur lors de la sauvegarde du contenu About:', error);
                showToast('Erreur lors de la sauvegarde', 'error');
            }
        }
        
        async function saveDeliveryPolicy() {
            try {
                const policyData = {
                    intro: document.getElementById('delivery-intro').value,
                    methods: document.getElementById('delivery-methods').value,
                    fees: document.getElementById('delivery-fees').value,
                    code: document.getElementById('delivery-code').value
                };
                
                console.log('Politique de livraison sauvegardée:', policyData);
                showToast('Politique de livraison sauvegardée', 'success');
                
            } catch (error) {
                console.error('Erreur lors de la sauvegarde de la politique:', error);
                showToast('Erreur lors de la sauvegarde', 'error');
            }
        }
        
        async function savePrivacyPolicy() {
            try {
                const policyData = {
                    intro: document.getElementById('privacy-intro').value,
                    data: document.getElementById('privacy-data').value,
                    usage: document.getElementById('privacy-usage').value,
                    security: document.getElementById('privacy-security').value
                };
                
                console.log('Politique de confidentialité sauvegardée:', policyData);
                showToast('Politique de confidentialité sauvegardée', 'success');
                
            } catch (error) {
                console.error('Erreur lors de la sauvegarde de la politique:', error);
                showToast('Erreur lors de la sauvegarde', 'error');
            }
        }
        
        function addTeamMember() {
            const teamMembers = document.getElementById('team-members');
            
            const memberDiv = document.createElement('div');
            memberDiv.className = 'team-member p-4 border border-gray-200 rounded-lg';
            memberDiv.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nom</label>
                        <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg team-name" placeholder="Nom du membre">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Fonction</label>
                        <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg team-role" placeholder="Rôle dans l'entreprise">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Image</label>
                        <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg team-image" placeholder="image.jpg">
                    </div>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                    <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg team-description" rows="2" placeholder="Description du membre"></textarea>
                </div>
                <div class="flex justify-end">
                    <button class="remove-team-member text-red-600 hover:text-red-800 text-sm">
                        <i class="fas fa-trash mr-1"></i> Supprimer
                    </button>
                </div>
            `;
            
            teamMembers.appendChild(memberDiv);
            
            // Ajouter le gestionnaire d'événements pour le bouton de suppression
            const removeBtn = memberDiv.querySelector('.remove-team-member');
            removeBtn.addEventListener('click', function() {
                memberDiv.remove();
            });
        }
        
        // ========== UTILITAIRES ==========
        function showToast(message, type = 'success') {
            const toast = document.getElementById('success-toast');
            const toastMessage = document.getElementById('toast-message');
            
            // Changer la couleur selon le type
            if (type === 'error') {
                toast.style.backgroundColor = '#ef4444';
            } else if (type === 'warning') {
                toast.style.backgroundColor = '#f59e0b';
            } else {
                toast.style.backgroundColor = '#10b981';
            }
            
            toastMessage.textContent = message;
            
            // Afficher le toast
            toast.style.transform = 'translateY(0)';
            
            // Masquer après 3 secondes
            setTimeout(() => {
                toast.style.transform = 'translateY(100%)';
            }, 3000);
        }
    </script>
</body>
</html>